<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Usando librerías externas &#8212; documentación de gvsig - 0</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/gvSIG.ico"/>
    <link rel="top" title="documentación de gvsig - 0" href="../index.html" />
    <link rel="next" title="Lenguaje R" href="rscript.html" />
    <link rel="prev" title="Capturando eventos: Listeners" href="capturando_eventos.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="rscript.html" title="Lenguaje R"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="capturando_eventos.html" title="Capturando eventos: Listeners"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentacion de Scripting en gvSIG 2.3</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="usando-librerias-externas">
<h1>Usando librerías externas<a class="headerlink" href="#usando-librerias-externas" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="gdal">
<h2>GDAL<a class="headerlink" href="#gdal" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hemos incluido una de las aplicaciones más comúnes de uso en GDAL que se denomina ogr2ogr. Para usarla desde un script podemos usar las siguientes líneas, modificando las rutas por las de nuestros datos. El resultado es una transformación de un fichero geojson a un shape:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gvsig</span> <span class="k">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">gvsig</span> <span class="k">import</span> <span class="n">uselib</span>
<span class="n">uselib</span><span class="o">.</span><span class="n">use_plugin</span><span class="p">(</span><span class="s2">&quot;org.gvsig.gdal.app.mainplugin&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">org.gvsig.gdal.app.mainplugin.common</span> <span class="k">import</span> <span class="n">ogr2ogr</span>


<span class="k">def</span> <span class="nf">gdalapp</span><span class="p">(</span><span class="n">argsAsString</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">shlex</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">argsAsString</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">&quot;Function: &quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span> <span class="s2">&quot;Args: &quot;</span><span class="p">,</span> <span class="n">x</span>
        <span class="n">ogr2ogr</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;ogr2ogr from gdal&quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ogr2ogr.main([&quot;-t_srs&quot;, &quot;CRS:84&quot;,</span>
<span class="sd">                                  &quot;-f&quot;,</span>
<span class="sd">                                  &quot;ESRI Shapefile&quot;,</span>
<span class="sd">                                  &quot;C:/temp/j1&quot;,</span>
<span class="sd">                                  &quot;C:/temp/countries.geojson&quot;,</span>
<span class="sd">                                  &quot;-overwrite&quot;,</span>
<span class="sd">                                  &quot;-skipfailures&quot;</span>
<span class="sd">                                  ])</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="n">gdalapp</span><span class="p">(</span><span class="s2">&quot;ogr2ogr -t_srs &#39;EPSG:4326&#39; -f &#39;ESRI Shapefile&#39; C://temp//j1.shp D://gvdata//countries023.geojson -overwrite -skipfailures&quot;</span><span class="p">)</span>
        <span class="n">loadShapeFile</span><span class="p">(</span><span class="s2">&quot;C:/temp/j1.shp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="jfreechart">
<h2>jfreechart<a class="headerlink" href="#jfreechart" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Una librería que viene con gvSIG es jfreechart y la podemos usar para generar gráficas.</p>
<p>Generar gráfica y guardarla en formato <code class="docutils literal"><span class="pre">.jpeg</span></code> en disco.</p>
<div class="figure align-center">
<img alt="../_images/pieChart.jpeg" src="../_images/pieChart.jpeg" />
</div>
<p>Código:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">java.io</span> <span class="k">import</span> <span class="n">File</span>
<span class="kn">from</span> <span class="nn">org.jfree.chart</span> <span class="k">import</span> <span class="n">ChartUtilities</span>
<span class="kn">from</span> <span class="nn">org.jfree.chart</span> <span class="k">import</span> <span class="n">ChartFactory</span>
<span class="kn">from</span> <span class="nn">org.jfree.chart</span> <span class="k">import</span> <span class="n">JFreeChart</span>
<span class="kn">from</span> <span class="nn">org.jfree.data.general</span> <span class="k">import</span> <span class="n">DefaultPieDataset</span>

<span class="c1">#Save chart into png file</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
          <span class="n">dataset</span> <span class="o">=</span> <span class="n">DefaultPieDataset</span><span class="p">(</span> <span class="p">)</span>
          <span class="n">dataset</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;IPhone 5s&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span> <span class="mi">20</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">dataset</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;SamSung Grand&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span> <span class="mi">20</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">dataset</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;MotoG&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span> <span class="mi">40</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">dataset</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;Nokia Lumia&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span> <span class="mi">10</span> <span class="p">)</span> <span class="p">)</span>

          <span class="n">chart</span> <span class="o">=</span> <span class="n">ChartFactory</span><span class="o">.</span><span class="n">createPieChart</span><span class="p">(</span>
                 <span class="s2">&quot;Mobile Sales&quot;</span><span class="p">,</span> <span class="c1"># chart title</span>
                 <span class="n">dataset</span><span class="p">,</span> <span class="c1"># data</span>
                 <span class="kc">True</span><span class="p">,</span> <span class="c1"># include legend</span>
                 <span class="kc">True</span><span class="p">,</span>
                 <span class="kc">False</span><span class="p">)</span>

          <span class="n">width</span> <span class="o">=</span> <span class="mi">640</span>
          <span class="n">height</span> <span class="o">=</span> <span class="mi">480</span>
          <span class="n">pieChart</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span> <span class="s2">&quot;D:/pieChart.jpeg&quot;</span> <span class="p">)</span>
          <span class="n">ChartUtilities</span><span class="o">.</span><span class="n">saveChartAsJPEG</span><span class="p">(</span> <span class="n">pieChart</span> <span class="p">,</span> <span class="n">chart</span> <span class="p">,</span> <span class="n">width</span> <span class="p">,</span> <span class="n">height</span> <span class="p">)</span>
</pre></div>
</div>
<p>Otro ejemplo que genera una pantalla con el resultado.</p>
<div class="figure align-center">
<img alt="../_images/simple_pie_chart.png" src="../_images/simple_pie_chart.png" />
</div>
<p>Código:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">org.jfree.chart</span> <span class="k">import</span> <span class="n">ChartFactory</span>
<span class="kn">from</span> <span class="nn">org.jfree.chart</span> <span class="k">import</span> <span class="n">ChartFrame</span>
<span class="kn">from</span> <span class="nn">org.jfree.chart</span> <span class="k">import</span> <span class="n">JFreeChart</span>
<span class="kn">from</span> <span class="nn">org.jfree.data.general</span> <span class="k">import</span> <span class="n">DefaultPieDataset</span>
<span class="kn">from</span> <span class="nn">org.jfree.ui</span> <span class="k">import</span> <span class="n">RefineryUtilities</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">* A simple introduction to using JFreeChart. This demo is described in the</span>
<span class="sd">* JFreeChart Developer Guide.</span>
<span class="sd">* Translated from Java to Jython by Alfonso Reyes</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="k">class</span> <span class="nc">First</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        * The starting point for the demo.</span>
<span class="sd">        *</span>
<span class="sd">        * @param args ignored.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create a dataset...</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DefaultPieDataset</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;Category 1&quot;</span><span class="p">,</span> <span class="mf">43.2</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;Category 2&quot;</span><span class="p">,</span> <span class="mf">27.9</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;Category 3&quot;</span><span class="p">,</span> <span class="mf">79.5</span><span class="p">)</span>
        <span class="c1"># create a chart...</span>
        <span class="n">chart</span> <span class="o">=</span> <span class="n">ChartFactory</span><span class="o">.</span><span class="n">createPieChart</span><span class="p">(</span>
                <span class="s2">&quot;Sample Pie Chart&quot;</span><span class="p">,</span>
                <span class="n">data</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span> <span class="c1"># legend?</span>
                <span class="kc">True</span><span class="p">,</span> <span class="c1">#tooltips?</span>
                <span class="kc">False</span> <span class="c1"># URLs?</span>
        <span class="p">)</span>
        <span class="c1"># create and display a frame...</span>

        <span class="n">frame</span> <span class="o">=</span> <span class="n">ChartFrame</span><span class="p">(</span><span class="s2">&quot;First&quot;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
        <span class="c1">#frame.setSize(100 , 100) #Position</span>
        <span class="c1">#RefineryUtilities.centerFrameOnScreen( frame )</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">First</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="jopendocument">
<h2>jOpenDocument<a class="headerlink" href="#jopendocument" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="section" id="editando-odt">
<h3>Editando ODT<a class="headerlink" href="#editando-odt" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Abrir nuevo documento de LibreOffice</p>
<p>jOpenDocument - Insert Field - fieldName</p>
<p>Insertar una imagen
Click derecho sobre la Imagen: Imagen - Opciones - Nombre: Imagen1</p>
</div>
<div class="section" id="editando-ods">
<h3>Editando ODS<a class="headerlink" href="#editando-ods" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Después de modificarlo hay que abrirlo y presionas control+mayusculas+f9 para recalcular las celdas</p>
</div>
</div>
<div class="section" id="ejemplos">
<h3>Ejemplos<a class="headerlink" href="#ejemplos" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Editar Spreadsheet ODS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gvsig</span> <span class="k">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">java.io</span> <span class="k">import</span> <span class="n">File</span>
<span class="kn">from</span> <span class="nn">java.util</span> <span class="k">import</span> <span class="n">Date</span>

<span class="kn">from</span> <span class="nn">org.jopendocument.model</span> <span class="k">import</span> <span class="n">OpenDocument</span>
<span class="kn">from</span> <span class="nn">org.jopendocument.dom.spreadsheet</span> <span class="k">import</span> <span class="n">SpreadSheet</span>
<span class="kn">from</span> <span class="nn">org.jopendocument.dom</span> <span class="k">import</span> <span class="n">OOUtils</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c1">#Ejemplo de Edicion de ficheros ODS con jOpenDocument</span>

    <span class="c1">#basado en http://www.jopendocument.org/start_spreadsheet_2.html</span>
    <span class="c1">#ficheros plantilla http://www.jopendocument.org/downloads.html</span>

    <span class="n">pathTemplate</span> <span class="o">=</span> <span class="s2">r&quot;C:/joo/invoice.ods&quot;</span>
    <span class="n">pathOutput</span> <span class="o">=</span> <span class="s2">r&quot;C:/joo/fillingTest1.ods&quot;</span>

    <span class="c1">#Acceso al spreadsheet y numero de hoja</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="n">pathTemplate</span><span class="p">)</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">SpreadSheet</span><span class="o">.</span><span class="n">createFromFile</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">getSheet</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#Establecer fecha actual a la castilla I10</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">getCellAt</span><span class="p">(</span><span class="s2">&quot;I10&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">Date</span><span class="p">())</span>

    <span class="c1">#Modifica el valor a la celda 1,1. Seria B2</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">setValueAt</span><span class="p">(</span><span class="s2">&quot;Template - 1&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1">#Varias modificaciones</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">getCellAt</span><span class="p">(</span><span class="s2">&quot;B27&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;On site support&quot;</span><span class="p">)</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">getCellAt</span><span class="p">(</span><span class="s2">&quot;F24&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">301</span><span class="p">)</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">getCellAt</span><span class="p">(</span><span class="s2">&quot;H27&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">350</span><span class="p">)</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">getSpreadSheet</span><span class="p">()</span><span class="o">.</span><span class="n">getTableModel</span><span class="p">(</span><span class="s2">&quot;Products&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setValueAt</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c1">#F27</span>

    <span class="c1">#Guardamos fichero</span>
    <span class="n">outputFile</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="n">pathOutput</span><span class="p">)</span>
    <span class="n">OOUtils</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">getSpreadSheet</span><span class="p">()</span><span class="o">.</span><span class="n">saveAs</span><span class="p">(</span><span class="n">outputFile</span><span class="p">))</span>
</pre></div>
</div>
<p>Editar Spreadsheet ODT:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gvsig</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">geom</span> <span class="k">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">java.io</span> <span class="k">import</span> <span class="n">File</span>
<span class="c1">#from org.jdom import Namespace</span>
<span class="kn">from</span> <span class="nn">java.util.Map</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span> <span class="k">as</span> <span class="nn">ArrayList</span>

<span class="kn">from</span> <span class="nn">org.jopendocument.dom.template</span> <span class="k">import</span> <span class="n">JavaScriptFileTemplate</span>
<span class="kn">from</span> <span class="nn">org.jopendocument.util.CollectionUtils</span> <span class="k">import</span> <span class="n">createMap</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="c1">#Ejemplo de Edicion de ficheros ODT con jOpenDocument</span>

    <span class="c1">#basado en http://www.jopendocument.org/start_text_2.html</span>
    <span class="c1">#ficheros plantilla http://www.jopendocument.org/downloads.html</span>

    <span class="n">pathTemplate</span> <span class="o">=</span> <span class="s2">r&quot;C:\joo\test.odt&quot;</span>
    <span class="n">pathOutput</span> <span class="o">=</span> <span class="s2">r&quot;C:\joo\test4&quot;</span>

    <span class="c1">#Creamos template</span>
    <span class="n">templateFile</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="n">pathTemplate</span><span class="p">)</span>
    <span class="n">outFile</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="n">pathOutput</span><span class="p">)</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">JavaScriptFileTemplate</span><span class="p">(</span><span class="n">templateFile</span><span class="p">)</span>

    <span class="c1"># Principal: Establacer valores de un campo</span>
    <span class="n">template</span><span class="o">.</span><span class="n">setField</span><span class="p">(</span><span class="s2">&quot;toto&quot;</span><span class="p">,</span> <span class="s2">&quot;value set using setField()&quot;</span><span class="p">)</span>
    <span class="n">template</span><span class="o">.</span><span class="n">setField</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;14&quot;</span><span class="p">)</span>
    <span class="c1">#Haciendo doble click sobre la linea verde aparece el nombre</span>
    <span class="c1">#al que hay que hacer referencia</span>
    <span class="n">template</span><span class="o">.</span><span class="n">hideParagraph</span><span class="p">(</span><span class="s2">&quot;p1&quot;</span><span class="p">)</span> <span class="c1">#showParagraph</span>
    <span class="n">template</span><span class="o">.</span><span class="n">showSection</span><span class="p">(</span><span class="s2">&quot;section1&quot;</span><span class="p">)</span> <span class="c1">#hideSection</span>


    <span class="c1">#Values de la tabla</span>
    <span class="n">months</span> <span class="o">=</span> <span class="n">ArrayList</span><span class="p">()</span>
    <span class="n">months</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">createMap</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span><span class="s2">&quot;January&quot;</span><span class="p">,</span>   <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;-12&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">))</span>
    <span class="n">months</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">createMap</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;February&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;-8&quot;</span><span class="p">,</span>  <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">))</span>
    <span class="n">months</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">createMap</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;March&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;-5&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;12&quot;</span><span class="p">))</span>
    <span class="n">months</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">createMap</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;April&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;15&quot;</span><span class="p">))</span>
    <span class="n">months</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">createMap</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;May&quot;</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="s2">&quot;21&quot;</span><span class="p">))</span>
    <span class="n">template</span><span class="o">.</span><span class="n">setField</span><span class="p">(</span><span class="s2">&quot;months&quot;</span><span class="p">,</span> <span class="n">months</span><span class="p">)</span>

    <span class="n">ddoc</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">createDocument</span><span class="p">()</span>
    <span class="n">ddoc</span><span class="o">.</span><span class="n">saveAs</span><span class="p">(</span><span class="n">outFile</span><span class="p">)</span>
</pre></div>
</div>
<p>Reemplazar imagen:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">pathImg</span> <span class="o">=</span> <span class="s2">r&quot;C:/joo/img02.png&quot;</span>
<span class="n">ddoc</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">createDocument</span><span class="p">()</span>
<span class="c1">#ddoc.getDescendantByName(&quot;draw:frame&quot;,&quot;Imagen1&quot;).setAttribute(&quot;href&quot;, &quot;file:///&quot; + pathImg,Namespace.getNamespace(&quot;xlink&quot;, &quot;http://www.w3.org/1999/xlink&quot;))</span>
<span class="n">ddoc</span><span class="o">.</span><span class="n">saveAs</span><span class="p">(</span><span class="n">outFile</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/gvsig_asoc.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Tabla de Contenidos</a></h3>
  <ul>
<li><a class="reference internal" href="#">Usando librerías externas</a><ul>
<li><a class="reference internal" href="#gdal">GDAL</a></li>
<li><a class="reference internal" href="#jfreechart">jfreechart</a></li>
<li><a class="reference internal" href="#jopendocument">jOpenDocument</a><ul>
<li><a class="reference internal" href="#editando-odt">Editando ODT</a></li>
<li><a class="reference internal" href="#editando-ods">Editando ODS</a></li>
<li><a class="reference internal" href="#ejemplos">Ejemplos</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="capturando_eventos.html"
                        title="capítulo anterior">Capturando eventos: Listeners</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="rscript.html"
                        title="próximo capítulo">Lenguaje R</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/docs/usando_librerias_externas.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Búsqueda rápida</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Ir a" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="rscript.html" title="Lenguaje R"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="capturando_eventos.html" title="Capturando eventos: Listeners"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Documentacion de Scripting en gvSIG 2.3</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Oscar.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.
    </div>
  </body>
</html>